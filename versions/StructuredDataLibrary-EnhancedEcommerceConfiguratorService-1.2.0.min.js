class ConfiguratorChoiceSelector{constructor(t,e,i){this.selector=t,this.eventType=e,this.onPriceCalculated=i}}class ConfiguratorInstructionSelector{constructor(t,e){this.selector=t,this.eventType=e}}class ChoiceEventSettings{constructor(t=[],e=null,i=[],r=null){this.configuratorChoiceSelectors=t,this.getChoiceMadeSchema=e,this.configuratorInstructionSelectors=i,this.getInstructionSchema=r}}class ErrorEventSettings{constructor(t,e){this.nextButtonSelector=t,this.getErrorSchemas=e}}class EnhancedEcommerceConfiguratorService extends EnhancedEcommerceService{constructor(t,e,i,r,n,s,o=null,h=null){super(),this.lastEvent="",this.currentStep=1,this.boundEventListeners=[],this.stepChanged=!1,this.choiceMadeForPriceCalculated=!1,this.configuratorType=t,this.getVirtualPageviewSchema=e,this.getStepCompleteSchema=i,this.getSummarySchema=r,this.getAddToBasketSchema=n,this.getPathChanged=s,this.choiceEventSettings=o,this.errorEventSettings=h,this.privateInit()}privateInit(){this.privatePushVirtualPageview(this.currentStep),this.privateInitBindings()}privateInitBindings(){this.privateBindChoices(),this.privateBindErrorsOnNext(),document.addEventListener("jconfiguratorStepLoaded",this.privateStepChanged.bind(this)),document.addEventListener("jconfiguratorStepRendered",this.privateBindChoices.bind(this)),document.addEventListener("jconfiguratorSubStepRendered",this.privateBindChoices.bind(this)),document.addEventListener("jconfiguratorSummaryLoaded",this.privateSummaryLoaded.bind(this)),document.addEventListener("jconfiguratorAddToBasket",this.privateAddedToBasket.bind(this)),document.addEventListener("jconfiguratorAfterCalculateTotalPrice",this.privatePriceCalculated.bind(this))}privateBindErrorsOnNext(){null!=this.errorEventSettings&&document.querySelectorAll(this.errorEventSettings.nextButtonSelector).forEach((t=>{t.addEventListener("click",(()=>{setTimeout((()=>{this.errorEventSettings.getErrorSchemas(this.currentStep,this.configuratorType).forEach((t=>{this.privatePushConfiguratorEvent("ErrorMessage",t)}))}),100)}))}))}privateStepChanged(){this.stepChanged=!0;const t=parseInt(new URLSearchParams(window.location.search).get("confloc").split("-")[0]);this.privatePushVirtualPageview(t),this.privateNextPreviousStep(t),this.privateBindErrorsOnNext()}privateNextPreviousStep(t){t<this.currentStep?this.privatePushConfiguratorEvent("Vorige stap",this.getPathChanged(this.currentStep,t)):t>this.currentStep&&this.privatePushConfiguratorEvent("Volgende stap",this.getPathChanged(this.currentStep,t))}privatePushConfiguratorEvent(t,e,i=document){const r=JSON.stringify(e.getData(i));this.lastEvent!==r&&this._pushCustomEvent(t,e,i),this.lastEvent=r}privateSummaryLoaded(){this.privatePushVirtualPageview(this.currentStep+1),this.privateNextPreviousStep(this.currentStep+1),this.privatePushStepComplete(this.currentStep+1),this.privatePushConfiguratorEvent("Samenvatting",this.getSummarySchema())}privateAddedToBasket(){const t=`Stap ${this.currentStep} afgerond - ${this.configuratorType}`;this.privatePushConfiguratorEvent(t,this.getAddToBasketSchema(this.currentStep))}privatePushVirtualPageview(t){this.privatePushConfiguratorEvent("VirtualPageview",this.getVirtualPageviewSchema(t))}privatePriceCalculated(){this.choiceMadeForPriceCalculated&&(this.choiceMadeForPriceCalculated=!1,this.privatePushChoiceMade(null)),this.stepChanged&&(this.stepChanged=!1,this.privatePushStepComplete(parseInt(new URLSearchParams(window.location.search).get("confloc").split("-")[0])))}privatePushStepComplete(t){if(this.currentStep<t){const t=`Stap ${this.currentStep} afgerond - ${this.configuratorType}`;this.privatePushConfiguratorEvent(t,this.getStepCompleteSchema(this.currentStep))}this.currentStep=t}privateBindChoices(){null!=this.choiceEventSettings&&(this.boundEventListeners.forEach((t=>{t.removeEvent()})),this.boundEventListeners=[],null!=this.choiceEventSettings.configuratorChoiceSelectors&&this.choiceEventSettings.configuratorChoiceSelectors.length>0&&null!=this.choiceEventSettings.getChoiceMadeSchema&&this.choiceEventSettings.configuratorChoiceSelectors.forEach((t=>{document.querySelectorAll(t.selector).forEach((e=>{const i=t.onPriceCalculated?this.privatePushChoiceMadeDelayed.bind(this):this.privatePushChoiceMade.bind(this);e.addEventListener(t.eventType,i),this.boundEventListeners.push(new BoundEventListener(e,i,t.eventType))}))})),null!=this.choiceEventSettings.configuratorInstructionSelectors&&this.choiceEventSettings.configuratorInstructionSelectors.length>0&&null!=this.choiceEventSettings.getInstructionSchema&&this.choiceEventSettings.configuratorInstructionSelectors.forEach((t=>{document.querySelectorAll(t.selector).forEach((e=>{const event=()=>{this.privatePushConfiguratorEvent("Informatie icoon",this.choiceEventSettings.getInstructionSchema(this.currentStep,this.configuratorType,e))};e.addEventListener(t.eventType,event),this.boundEventListeners.push(new BoundEventListener(e,event,t.eventType))}))})))}privatePushChoiceMade(t){const e=`Keuzes stap ${this.currentStep} - ${this.configuratorType}`;this.privatePushConfiguratorEvent(e,this.choiceEventSettings.getChoiceMadeSchema(this.currentStep,null==t?null:t.currentTarget))}privatePushChoiceMadeDelayed(){this.choiceMadeForPriceCalculated=!0}}